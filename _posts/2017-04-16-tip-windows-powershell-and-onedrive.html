---
layout: post
title: 'Tip: Windows PowerShell and OneDrive'
date: 2017-04-16 11:57:09.000000000 +02:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Tech Notes
tags:
- OneDrive
- Windows PowerShell
meta:
  _edit_last: '14213986'
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  _publicize_job_id: '4051056104'
author:


  display_name: ngeor
  first_name: Nikolaos
  last_name: Georgiou
---
<p>If your Windows PowerShell profile is inside your OneDrive folder and you don't like that, this is what you have to do:<!--more--></p>
<ul>
<li>open the Registry Editor</li>
<li>navigate to HKEY_CURRENT_USER, SOFTWARE, Microsoft, Windows, CurrentVersion, Explorer, User Shell Folders</li>
<li>change the Personal key's value</li>
</ul>
<p><img class="alignnone size-full wp-image-1878" src="{{ site.baseurl }}/assets/2017-04-16-13_51_21-registry-editor.png" alt="2017-04-16 13_51_21-Registry Editor.png" width="950" height="487" /></p>
<p>In this example, the old value of the Personal folder was C:\Users\ngeor\OneDrive\Documents. This is what Windows PowerShell uses to determine where the profile should live. Changing this to the non-OneDrive old school "My Documents" folder (C:\Users\ngeor\Documents in my case) works for PowerShell too.</p>
<p>Of course, the impact is that all applications will now think that the OneDrive location is not the default, so be aware of that.</p>
<p>References:</p>
<ul>
<li><a href="https://blogs.technet.microsoft.com/heyscriptingguy/2012/05/21/understanding-the-six-powershell-profiles/" target="_blank">Understanding the Six PowerShell Profiles</a></li>
<li><a href="https://technet.microsoft.com/en-us/library/cc962613.aspx" target="_blank">User Shell Folders</a></li>
<li><a href="https://support.microsoft.com/en-us/help/931087/how-to-redirect-user-shell-folders-to-a-specified-path-by-using-profile-maker" target="_blank">How to redirect user shell folders to a specified path by using Profile Maker</a></li>
</ul>
