---
layout: post
title: Removing the image-tag.txt artifact
date: 2017-12-29 09:37:12.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Code
tags:
- blog-helm-sample
- TeamCity
meta:
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  _publicize_job_id: '12995952702'
author:


  display_name: ngeor
  first_name: Nikolaos
  last_name: Georgiou
excerpt: Small update on replacing the image-tag.txt artifact with the implicit build.number
  parameter.
---
<p>In the post about <a href="https://ngeor.wordpress.com/2017/12/02/cd-with-helm-part-5-versioned-artifacts/">versioned artifacts</a>, I was using a custom text file named <code>image-tag.txt</code> to share the image tag between build configurations. The commit stage evaluates the image tag and produces the <code>image-tag.txt</code> artifact, which just contains the version e.g. <code>1.3.0</code>.</p>
<p>After the post <a href="https://ngeor.wordpress.com/2017/12/20/one-script-to-version-all/">about the versioning script</a>, the build number of the commit stage and the image tag where identical and they were following semantic versioning.</p>
<p>In a more recent post, I've configured a <a href="https://ngeor.wordpress.com/2017/12/27/build-chains-in-teamcity/">build chain</a> in TeamCity, in which all build configurations share the build number of the Commit Stage. This means that all build configurations have the correct image tag information implicitly, as their build number. This makes the <code>image-tag.txt</code> artifact <strong>obsolete</strong>.</p>
<p>I have therefore removed the <code>image-tag.txt</code> artifact and I'm using the implicit configuration parameter <code>%build.number%</code> wherever I need it. The pull request is available <a href="https://github.com/ngeor/blog-helm/pull/8/files">here</a>.</p>
