---
layout: post
title: Ubuntu Postfix DNS errors
date: 2013-11-23 06:59:09.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Code
tags: []
meta:
  restapi_import_id: 586b47d26eba1
  original_post_id: '15'
  _wp_old_slug: '15'
  _edit_last: '14213986'
  _publicize_job_id: '4016978645'
author:


  display_name: ngeor
  first_name: Nikolaos
  last_name: Georgiou
---
<p>I&#039;ve got Postfix setup on my local desktop computer and on my server. On my local desktop, every now and then Postfix stops sending e-mails. The <code>/var/log/syslog</code> gets filled up with DNS related errors:</p>
<p>[code]<br />
Nov 22 20:24:49 box postfix/smtp[5180]: 09C212FC0859:<br />
to=&lt;email-address&gt;, relay=none, delay=69887,<br />
delays=69887/0.01/0/0, dsn=4.4.3,<br />
status=deferred (Host or domain name not found.<br />
Name service error for name=ngeor.net type=MX:<br />
Host not found, try again)<br />
[/code]</p>
<p>I know there&#039;s nothing wrong with my server, because it can pick up e-mails correctly from other sources, so it must be something wrong with Postfix on my local desktop.</p>
<p>Digging around in the usual places (<code>/etc/resolv.conf</code>) didn&#039;t help much, after all I didn&#039;t experience any other DNS problems using my desktop.</p>
<p>So, <abbr title="Today I learned">TIL</abbr>: Postfix is actually using its own resolv.conf, which can be found in <code>/var/spool/postfix/etc/resolv.conf</code>. And in my case, that file was empty...</p>
<p>I&#039;m not sure what caused the file to become empty, so I&#039;ll keep an eye for that.</p>
<p>I did find a script in <code>/etc/resolvconf/update-libc.d/postfix</code> which copies the <code>/etc/resolv.conf</code> over to Postfix&#039;s resolv.conf, so I&#039;m assuming that something went wrong there.</p>
<p>Additionally, when running Ubuntu as a desktop, it typically uses its own local caching DNS server, which isn&#039;t the case with the server version. So this could also be causing some problems.</p>
<p>For now I just copied over the correct contents from <code>/etc/resolv.conf</code> to Postfix&#039;s resolv.conf, which solves the problem (until next time that file somehow gets empty).</p>
